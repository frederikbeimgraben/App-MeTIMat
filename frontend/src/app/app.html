<div
  class="h-dvh flex flex-col relative overflow-hidden"
  [class.items-center]="!currentRoute.startsWith('admin')"
  [class.bg-gray-100]="!currentRoute.startsWith('admin')"
  [class.bg-white]="currentRoute.startsWith('admin')"
>
  <!-- Main content area -->
  <main
    class="flex-1 w-full relative overflow-hidden bg-white flex flex-col"
    [class.max-w-md]="!currentRoute.startsWith('admin')"
    [class.shadow-2xl]="!currentRoute.startsWith('admin')"
    [class.mb-16]="authService.isAuthenticated() && !currentRoute.startsWith('admin')"
  >
    <router-outlet></router-outlet>
  </main>

  <!-- Bottom Navigation Bar - Only show when authenticated and not in admin view -->
  @if (authService.isAuthenticated() && !currentRoute.startsWith('admin')) {
  <nav
    class="fixed bottom-0 w-full max-w-md left-1/2 -translate-x-1/2 bg-white border-t-2 border-gray-200 z-50"
  >
    <div class="mx-auto">
      <div class="flex justify-around items-center h-16">
        <!-- Orders (Bestellungen) -->
        <button
          (click)="navigateTo('orders')"
          [class.text-blue-900]="isActive('orders')"
          [class.text-gray-600]="!isActive('orders')"
          class="flex flex-col items-center justify-center w-[64px] py-2 px-3 transition-colors relative"
          [attr.aria-label]="'navigation.orders' | transloco"
        >
          <mat-icon class="mb-1" style="width: 24px; height: 24px; font-size: 24px"
            >shopping_bag</mat-icon
          >
          <span class="text-xs font-medium">{{ 'navigation.orders' | transloco }}</span>
          @if (activeOrderCount > 0) {
          <span
            class="absolute top-1 right-2 bg-blue-600 text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center font-bold"
          >
            {{ activeOrderCount }}
          </span>
          }
        </button>

        <!-- Home (Center) -->
        <button
          (click)="navigateTo('')"
          [class.text-blue-900]="isActive('home')"
          [class.text-gray-600]="!isActive('home')"
          class="flex flex-col items-center justify-center w-[64px] py-2 px-3 transition-colors"
          [attr.aria-label]="'navigation.home' | transloco"
        >
          <div
            class="w-12 h-12 rounded-full flex items-center justify-center -mt-2 shadow-lg"
            [class.bg-blue-900]="isActive('home')"
            [class.bg-gray-600]="!isActive('home')"
          >
            <mat-icon class="text-white" style="width: 28px; height: 28px; font-size: 28px"
              >home</mat-icon
            >
          </div>
        </button>

        <!-- Map -->
        <button
          (click)="navigateTo('map')"
          [class.text-blue-900]="isActive('map')"
          [class.text-gray-600]="!isActive('map')"
          class="flex flex-col items-center justify-center w-[64px] py-2 px-3 transition-colors"
          aria-label="Map"
        >
          <mat-icon class="mb-1" style="width: 24px; height: 24px; font-size: 24px">map</mat-icon>
          <span class="text-xs font-medium">Map</span>
        </button>
      </div>
    </div>
  </nav>
  }

  <!-- Floating Cart Button -->
  @if (authService.isAuthenticated() && !currentRoute.startsWith('admin') && currentRoute !== 'cart'
  && cartItemCount > 0) {
  <div class="fixed bottom-20 w-full max-w-md left-1/2 -translate-x-1/2 pointer-events-none z-[60]">
    <div class="relative w-full h-full">
      <button
        (click)="navigateTo('cart')"
        class="absolute right-4 bottom-0 w-14 h-14 bg-blue-900 text-white rounded-full shadow-2xl flex items-center justify-center pointer-events-auto hover:scale-110 active:scale-95 transition-all"
        aria-label="Warenkorb"
      >
        <mat-icon style="width: 28px; height: 28px; font-size: 28px">shopping_cart</mat-icon>
        <span
          class="absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full border-2 border-white shadow-sm"
        >
          {{ cartItemCount }}
        </span>
      </button>
    </div>
  </div>
  }
</div>
