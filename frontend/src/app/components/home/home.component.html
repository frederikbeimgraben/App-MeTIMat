<div class="h-screen bg-gray-50 flex flex-col overflow-hidden">
  <!-- Header -->
  <header
    class="border-b-2 border-gray-200 header-blur absolute top-0 left-0 right-0 z-20 bg-white"
  >
    <div class="background"></div>
    <div class="background"></div>
    <div class="background"></div>
    <div class="max-w-md mx-auto px-4 py-4 flex justify-between items-center">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">
          <span class="text-blue-900">MeTI</span><span class="text-teal-500">Mat</span>
        </h1>
        <p class="text-sm text-gray-600">{{ 'app.subtitle' | transloco }}</p>
      </div>
      <div class="flex items-center space-x-1">
        @if (authService.isAdmin()) {
          <button
            (click)="goToAdmin()"
            class="p-2 text-blue-900 hover:bg-gray-100 rounded-full transition-colors"
            aria-label="Admin"
          >
            <mat-icon style="width: 24px; height: 24px; font-size: 24px"
              >admin_panel_settings</mat-icon
            >
          </button>
        }
        <button
          (click)="logout()"
          class="p-2 text-gray-600 hover:bg-gray-100 rounded-full transition-colors"
          aria-label="Logout"
        >
          <mat-icon style="width: 24px; height: 24px; font-size: 24px">logout</mat-icon>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content Wrapper -->
  <div class="flex-1 flex flex-col pt-20 max-w-md mx-auto w-full h-full">
    <!-- Fixed Actions Area -->
    <div class="px-4 py-4 flex-shrink-0 space-y-4">
      <!-- Start New Order Flow -->
      <div class="bg-white rounded-lg shadow-sm border-2 border-blue-900">
        <button
          (click)="startNewOrder()"
          class="w-full p-6 text-left flex items-center justify-between hover:bg-blue-50 transition-colors rounded-lg"
        >
          <div class="flex items-center">
            <div class="w-12 h-12 bg-blue-900 rounded-full flex items-center justify-center mr-4">
              <mat-icon class="text-white" style="width: 24px; height: 24px; font-size: 24px"
                >add</mat-icon
              >
            </div>
            <div>
              <h3 class="font-semibold text-gray-900">{{ 'home.startFlow' | transloco }}</h3>
              <p class="text-sm text-gray-600 mt-1">
                {{ 'home.importPrescription' | transloco }} /
                {{ 'home.searchMedication' | transloco }}
              </p>
            </div>
          </div>
          <mat-icon class="text-gray-400" style="width: 20px; height: 20px; font-size: 20px"
            >chevron_right</mat-icon
          >
        </button>
      </div>

      <!-- Additional Quick Actions Grid -->
      <div class="grid grid-cols-2 gap-4">
        <!-- Show Locations (Map) -->
        <button
          (click)="showMachineLocations()"
          class="bg-white rounded-lg shadow-sm border-2 border-gray-200 p-4 hover:border-blue-900 hover:bg-blue-50 transition-all"
        >
          <div class="flex flex-col items-center">
            <mat-icon class="text-blue-900 mb-2" style="width: 32px; height: 32px; font-size: 32px"
              >map</mat-icon
            >
            <span class="text-sm font-medium text-gray-900">Map View</span>
          </div>
        </button>

        <!-- My Orders -->
        <button
          (click)="viewMyOrders()"
          class="bg-white rounded-lg shadow-sm border-2 border-gray-200 p-4 hover:border-blue-900 hover:bg-blue-50 transition-all"
        >
          <div class="flex flex-col items-center">
            <mat-icon class="text-blue-900 mb-2" style="width: 32px; height: 32px; font-size: 32px"
              >assignment</mat-icon
            >
            <span class="text-sm font-medium text-gray-900">{{
              'order.myOrders' | transloco
            }}</span>
          </div>
        </button>

        <!-- My Prescriptions -->
        <button
          (click)="viewMyPrescriptions()"
          class="bg-white rounded-lg shadow-sm border-2 border-gray-200 p-4 hover:border-blue-900 hover:bg-blue-50 transition-all"
        >
          <div class="flex flex-col items-center">
            <mat-icon class="text-blue-900 mb-2" style="width: 32px; height: 32px; font-size: 32px"
              >description</mat-icon
            >
            <span class="text-sm font-medium text-gray-900">{{
              'prescription.myPrescriptions' | transloco
            }}</span>
          </div>
        </button>
      </div>
    </div>
  </div>

  <!-- Active Orders Section (Scrollable) -->
  <div class="flex-1 overflow-y-auto px-4 pb-20">
    @if (activeOrders.length > 0) {
      <div class="mt-2">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-lg font-bold text-gray-900">{{ 'home.activeOrders' | transloco }}</h2>
          <button
            (click)="viewAllOrders()"
            class="text-sm text-blue-900 font-medium hover:underline"
          >
            View All
          </button>
        </div>
        <div class="space-y-3">
          @for (order of activeOrders; track order.id) {
            <div
              (click)="viewOrder(order.id)"
              class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors"
            >
              <div class="flex justify-between items-start">
                <div>
                  <div class="font-semibold text-gray-900">{{ order.id }}</div>
                  <div class="text-xs text-gray-500 mt-1">
                    {{ order.authoredOn || order.created_at | date: 'short' }}
                  </div>
                </div>
                <span
                  [class]="
                    'px-2 py-1 rounded-full text-[10px] font-bold uppercase ' +
                    getOrderStatusColor(order.status)
                  "
                >
                  {{ order.status }}
                </span>
              </div>
            </div>
          }
        </div>
      </div>
    }
  </div>
</div>
