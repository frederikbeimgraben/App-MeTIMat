<div class="h-full bg-gray-50 pb-32">
  <!-- Header -->
  <app-header-common titleKey="navigation.orders" [hasBackButton]="false"></app-header-common>

  <!-- Content -->
  <div class="max-w-md mx-auto px-4 py-4 overflow-y-auto">
    <!-- Active Orders -->
    @if (activeOrders.length > 0) {
      <div class="mb-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-3">
          {{ 'order.status.ready' | transloco }}
        </h2>
        <div class="space-y-3">
          @for (order of activeOrders; track order.id) {
            <div
              (click)="viewOrder(order.id)"
              class="bg-white rounded-lg shadow-sm border-2 border-gray-200 p-4 cursor-pointer hover:border-blue-900 transition-all"
            >
              <div class="flex justify-between items-start mb-3">
                <div>
                  <p class="font-semibold text-gray-900">
                    {{
                      order.identifier?.[0]?.value
                        ? order.identifier?.[0]?.value
                        : 'Bestellung #' + order.id
                    }}
                  </p>
                  <p class="text-sm text-gray-600">
                    {{ order.authoredOn || order.created_at | date: 'medium' }}
                  </p>
                </div>
                <span
                  [class]="
                    'px-3 py-1 text-sm font-semibold rounded-full ' + getStatusColor(order.status)
                  "
                >
                  {{ 'order.status.' + (order.status || 'unknown') | transloco }}
                </span>
              </div>

              <div class="border-t pt-3">
                <p class="text-sm text-gray-600 mb-1">
                  <mat-icon
                    class="align-bottom text-gray-400 mr-1 mb-[0.2rem]"
                    style="font-size: 16px; width: 16px; height: 16px"
                    >place</mat-icon
                  >
                  {{
                    order.location?.name ||
                      order.locationReference?.[0]?.display ||
                      ('cart.pickupLocation' | transloco)
                  }}
                </p>
              </div>

              <div class="mt-3 flex justify-end items-center">
                @if (order.status === 'available for pickup' || $any(order.status) === 'active') {
                  <button
                    (click)="viewOrder(order.id)"
                    class="text-blue-900 font-medium text-sm hover:underline"
                  >
                    {{ 'order.viewDetails' | transloco }} â†’
                  </button>
                }
              </div>
            </div>
          }
        </div>
      </div>
    }

    <!-- Completed Orders -->
    @if (completedOrders.length > 0) {
      <div>
        <h2 class="text-lg font-semibold text-gray-900 mb-3">
          {{ 'order.status.completed' | transloco }}
        </h2>
        <div class="space-y-3">
          @for (order of completedOrders; track order.id) {
            <div
              (click)="viewOrder(order.id)"
              class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 cursor-pointer hover:shadow-md transition-all opacity-75"
            >
              <div class="flex justify-between items-start">
                <div>
                  <p class="font-medium text-gray-900">
                    {{
                      order.identifier?.[0]?.value
                        ? order.identifier?.[0]?.value
                        : 'Bestellung #' + order.id
                    }}
                  </p>
                  <p class="text-sm text-gray-500">
                    {{ order.authoredOn || order.created_at | date: 'medium' }}
                  </p>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    }

    <!-- Empty State -->
    @if (!loading && orders.length === 0) {
      <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center mt-8">
        <mat-icon
          class="text-gray-400 mx-auto mb-4 block"
          style="width: 64px; height: 64px; font-size: 64px"
          >assignment</mat-icon
        >
        <h3 class="text-lg font-semibold text-gray-900 mb-2">{{ 'order.noOrders' | transloco }}</h3>
        <button (click)="startNewOrder()" class="btn btn-primary mt-4">
          {{ 'home.startFlow' | transloco }}
        </button>
      </div>
    }

    <!-- Loading State -->
    @if (loading) {
      <div class="flex justify-center items-center py-12">
        <div class="spinner"></div>
      </div>
    }
  </div>
</div>
